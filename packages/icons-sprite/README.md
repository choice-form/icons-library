# @choiceform/icons-sprite

将 SVG 图标文件生成为 SVG sprite（symbol 格式），支持 CLI 和 API 两种使用方式。

## 📦 安装

```bash
# pnpm
pnpm add @choiceform/icons-sprite

# npm
npm install @choiceform/icons-sprite

# yarn
yarn add @choiceform/icons-sprite
```

## 🚀 快速开始

### CLI 使用

```bash
# 基础使用
npx icons-sprite ./src/icons --output ./public/icons.svg

# 生成类型定义
npx icons-sprite ./src/icons --output ./public/icons.svg --generate-types --types-output ./src/types/icons.d.ts

# 使用配置文件
npx icons-sprite --config ./sprite.config.js

# 创建配置文件
npx icons-sprite init
```

### API 使用

```typescript
import { generateSprite } from "@choiceform/icons-sprite";

const result = await generateSprite({
  input: "./src/icons",
  output: "./public/icons.svg",
  prefix: "icon-",
  optimize: true,
  generateTypes: true,
  typesOutput: "./src/types/icons.d.ts",
});

console.log(`生成了 ${result.symbolCount} 个图标`);
```

## ⚙️ 配置

### 配置文件

支持以下配置文件名：

- `sprite.config.js`
- `sprite.config.mjs`
- `sprite.config.ts`
- `icons-sprite.config.js`
- `icons-sprite.config.mjs`
- `icons-sprite.config.ts`

```javascript
// sprite.config.js
export default {
  input: "./src/icons",
  output: "./public/icons.svg",
  prefix: "icon-",
  suffix: "",
  optimize: true,
  generateTypes: true,
  typesOutput: "./src/types/icons.d.ts",

  // 自定义 ID 生成
  idGenerator: (filename, filepath) => {
    return filename.replace(/\.svg$/, "").toLowerCase();
  },

  // 文件过滤
  filter: (filepath) => {
    return !filepath.includes("deprecated");
  },

  // SVGO 配置
  svgoConfig: {
    plugins: ["preset-default", { name: "removeViewBox", active: false }],
  },
};
```

### 配置选项

| 选项            | 类型                 | 默认值  | 描述                     |
| --------------- | -------------------- | ------- | ------------------------ |
| `input`         | `string \| string[]` | -       | 输入目录或文件模式       |
| `output`        | `string`             | -       | 输出文件路径             |
| `prefix`        | `string`             | `''`    | Symbol ID 前缀           |
| `suffix`        | `string`             | `''`    | Symbol ID 后缀           |
| `optimize`      | `boolean`            | `true`  | 是否优化 SVG             |
| `svgoConfig`    | `SvgoConfig`         | -       | SVGO 配置                |
| `generateTypes` | `boolean`            | `false` | 是否生成 TypeScript 类型 |
| `typesOutput`   | `string`             | -       | TypeScript 类型输出路径  |
| `idGenerator`   | `function`           | -       | 自定义 ID 生成函数       |
| `includeHidden` | `boolean`            | `false` | 是否包含隐藏文件         |
| `filter`        | `function`           | -       | 文件过滤函数             |

## 📄 输出格式

### SVG Sprite

```xml
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="icon-search" viewBox="0 0 24 24">
    <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
  </symbol>
  <symbol id="icon-home" viewBox="0 0 24 24">
    <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3"/>
  </symbol>
</svg>
```

### TypeScript 类型

```typescript
// Auto-generated by @choiceform/icons-sprite
export type IconName = "search" | "home" | "user";

export interface IconMap {
  search: string;
  home: string;
  user: string;
}

export const iconNames = ["search", "home", "user"] as const;
```

## 🔧 在项目中使用

### 1. HTML 中使用

```html
<!-- 引入 sprite 文件 -->
<svg style="display: none;">
  <!-- sprite 内容 -->
</svg>

<!-- 使用图标 -->
<svg>
  <use href="#icon-search"></use>
</svg>
```

### 2. React 中使用

```tsx
// IconSprite.tsx
export function IconSprite() {
  return <svg style={{ display: "none" }}>{/* sprite 内容 */}</svg>;
}

// Icon.tsx
interface IconProps {
  name: string;
  size?: number;
  className?: string;
}

export function Icon({ name, size = 24, className }: IconProps) {
  return (
    <svg width={size} height={size} className={className}>
      <use href={`#${name}`} />
    </svg>
  );
}

// 使用
<Icon name="icon-search" size={20} />;
```

### 3. Vue 中使用

```vue
<!-- Icon.vue -->
<template>
  <svg :width="size" :height="size" :class="className">
    <use :href="`#${name}`" />
  </svg>
</template>

<script setup lang="ts">
interface Props {
  name: string;
  size?: number;
  className?: string;
}

withDefaults(defineProps<Props>(), {
  size: 24,
});
</script>

<!-- 使用 -->
<Icon name="icon-search" :size="20" />
```

## 🔨 开发

```bash
# 克隆项目
git clone <repo-url>
cd icons-sprite

# 安装依赖
pnpm install

# 开发模式
pnpm dev

# 构建
pnpm build

# 测试
pnpm test
```

## 📄 许可证

MIT
